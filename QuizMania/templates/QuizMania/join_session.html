{% extends 'QuizMania/base.html' %}

{% block title %}Join a Session - Quiz Mania{% endblock %}

{% block content %}

<!-- 
        NEON THEME STYLES 
    -->
<link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap"
    rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    /* --- THEME VARIABLES --- */
    :root {
        --neon-blue: #00f3ff;
        --neon-pink: #ff00ff;
        --neon-red: #ff0055;
        --dark-bg: #050510;
        --glass-bg: rgba(10, 10, 30, 0.6);
    }

    /* FORCE DARK BACKGROUND */
    html,
    body {
        background-color: var(--dark-bg) !important;
        color: white !important;
        font-family: 'Rajdhani', sans-serif;
        min-height: 100vh;
        margin: 0;
        overflow-x: hidden;
    }

    /* AGGRESSIVE RESET */
    body>div,
    main,
    section {
        background-color: transparent !important;
    }

    /* --- ANIMATED BACKGROUND --- */
    .cyber-grid-fixed {
        position: fixed;
        top: 0;
        left: 0;
        width: 200vw;
        height: 200vh;
        background-color: var(--dark-bg);
        background-image:
            linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
        background-size: 50px 50px;
        transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
        animation: grid-move 20s linear infinite;
        z-index: 0;
        pointer-events: none;
    }

    @keyframes grid-move {
        0% {
            transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px);
        }

        100% {
            transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-200px);
        }
    }

    /* --- UTILITIES --- */
    .glass-panel {
        background: var(--glass-bg);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(0, 243, 255, 0.2);
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    }

    /* --- NAV BAR STYLES --- */
    .nav-scanline {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--neon-blue), transparent);
        animation: scan-nav 4s linear infinite;
    }

    @keyframes scan-nav {
        0% {
            transform: translateX(-100%);
        }

        100% {
            transform: translateX(100%);
        }
    }

    /* --- FORM STYLING --- */
    .cyber-label {
        display: block;
        font-family: 'Orbitron', sans-serif;
        color: var(--neon-blue);
        font-size: 0.85rem;
        letter-spacing: 2px;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        text-shadow: 0 0 5px rgba(0, 243, 255, 0.3);
    }

    .input-group input {
        width: 100%;
        background: rgba(0, 0, 0, 0.6);
        border: 1px solid #333;
        border-left: 2px solid var(--neon-blue);
        color: white;
        padding: 12px 16px 12px 45px;
        font-family: 'Rajdhani', sans-serif;
        font-size: 1.1rem;
        font-weight: 500;
        outline: none;
        transition: all 0.3s ease;
        clip-path: polygon(0 0, 100% 0, 100% 85%, 97% 100%, 0 100%);
    }

    .input-group input:focus {
        background: rgba(0, 243, 255, 0.05);
        border-color: var(--neon-pink);
        border-left-color: var(--neon-pink);
        box-shadow: 0 0 15px rgba(255, 0, 255, 0.1);
    }

    .input-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #666;
        transition: 0.3s;
        z-index: 10;
    }

    .input-group:focus-within .input-icon {
        color: var(--neon-blue);
        text-shadow: 0 0 8px var(--neon-blue);
    }

    /* Cyber Buttons */
    .btn-cyber {
        position: relative;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        font-family: 'Orbitron', sans-serif;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        color: white;
        background: transparent;
        border: 1px solid var(--neon-blue);
        overflow: hidden;
        transition: 0.3s;
        clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%);
        padding: 1rem 2rem;
        cursor: pointer;
    }

    .btn-cyber:hover {
        background: rgba(0, 243, 255, 0.1);
        text-shadow: 0 0 10px var(--neon-blue);
        box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
    }
</style>

<!-- Background Animation -->
<div class="cyber-grid-fixed"></div>

<!-- Navigation Bar -->
<nav class="fixed top-0 w-full glass-panel z-50 px-6 py-4">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
        <!-- Logo -->
        <a href="/" class="flex items-center gap-2 group">
            <i class="fas fa-brain text-3xl text-pink-500 group-hover:animate-pulse"></i>
            <div class="text-2xl font-bold tracking-widest text-white brand-font">
                QUIZ <span class="text-blue-400">MANIA</span>
            </div>
        </a>

        <!-- Nav Links -->
        <div class="hidden md:flex items-center gap-8 text-sm font-bold tracking-widest">
            <a href="/" class="text-gray-300 hover:text-blue-400 transition duration-300">HOME</a>

            {% if user.is_authenticated %}
            <div class="flex gap-4 items-center">
                <a href="{% url 'logout' %}"
                    class="border border-red-500 px-4 py-1 text-red-400 hover:bg-red-500/20 rounded text-xs flex items-center transition">
                    LOGOUT
                </a>
            </div>
            {% endif %}
        </div>

        <button class="md:hidden text-2xl text-blue-400">
            <i class="fas fa-bars"></i>
        </button>
    </div>
    <div class="nav-scanline"></div>
</nav>

<!-- Main Content -->
<div class="min-h-screen w-full flex items-center justify-center px-4 pt-24 pb-10 relative z-10">

    <!-- Join Card -->
    <div class="glass-panel w-full max-w-lg p-8 md:p-12 rounded-xl relative">

        <!-- Header -->
        <div class="text-center mb-10">
            <div
                class="inline-block p-4 rounded-full border border-blue-500/50 bg-black/40 mb-4 shadow-[0_0_15px_rgba(0,243,255,0.2)]">
                <i class="fas fa-gamepad text-3xl text-pink-500"></i>
            </div>
            <h1 class="text-3xl font-bold font-orbitron text-white tracking-wider">
                JOIN <span class="text-blue-400">SESSION</span>
            </h1>
            <p class="text-xs text-gray-400 tracking-[0.3em] mt-2">ENTER CREDENTIALS TO CONNECT</p>
        </div>

        <!-- Error Display (Styled as Alert) -->
        {% if error %}
        <div
            class="mb-8 p-4 border-l-4 border-red-500 bg-red-900/20 rounded text-red-300 text-sm flex items-start gap-3 animate-pulse">
            <i class="fas fa-exclamation-triangle mt-1"></i>
            <div>
                <strong class="block font-orbitron tracking-wider mb-1">CONNECTION ERROR</strong>
                {{ error }}
            </div>
        </div>
        {% endif %}

        <!-- Form -->
        <form method="post" class="cyber-form">
            {% csrf_token %}

            <!-- Quiz Code -->
            <div class="mb-6">
                <label class="cyber-label" for="quiz_code">Access Code</label>
                <div class="relative input-group">
                    <i class="fas fa-key input-icon"></i>
                    <input type="text" name="code" id="quiz_code" placeholder="ENTER 6-DIGIT CODE" required
                        autocomplete="off" class="tracking-widest uppercase">
                </div>
            </div>

            <!-- Username -->
            <div class="mb-8">
                <label class="cyber-label" for="player_name">Player Alias</label>
                <div class="relative input-group">
                    <i class="fas fa-user-astronaut input-icon"></i>
                    <input type="text" name="username" id="player_name" placeholder="ENTER YOUR USERNAME" required
                        autocomplete="off">
                </div>
            </div>

            <!-- Submit Button -->
            <div>
                <button type="submit" class="btn-cyber w-full py-4 font-bold text-lg clip-path-button group">
                    <span class="group-hover:animate-pulse">CONNECT TO LOBBY</span>
                    <i class="fas fa-network-wired ml-2 text-sm"></i>
                </button>
            </div>
        </form>

        <!-- Decorative Corner Markers -->
        <div class="absolute top-0 left-0 w-3 h-3 border-t border-l border-blue-500"></div>
        <div class="absolute top-0 right-0 w-3 h-3 border-t border-r border-blue-500"></div>
        <div class="absolute bottom-0 left-0 w-3 h-3 border-b border-l border-blue-500"></div>
        <div class="absolute bottom-0 right-0 w-3 h-3 border-b border-r border-blue-500"></div>

    </div>
</div>

{% endblock %}